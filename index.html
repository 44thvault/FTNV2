<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Florida Trees News</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@700&family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --ink: #111009; --ink2: #2e2c28; --ink3: #6b665e;
  --paper: #f5f0e8; --paper2: #ede8dd; --paper3: #e2dcd0;
  --rule: rgba(17,16,9,0.14); --green: #1f6b38; --green2: #174f29; --red: #8b1a1a;
  --f-mast: 'Courier Prime','Courier New',monospace;
  --f-head: 'Playfair Display',serif;
  --f-body: 'Libre Baskerville',serif;
  --f-mono: 'IBM Plex Mono',monospace;
  --g: 24px; --max: 960px;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;}
body{font-family:var(--f-body);background:var(--paper);color:var(--ink);overflow-x:hidden;-webkit-font-smoothing:antialiased;}
a{color:inherit;text-decoration:none;}

.topbar{background:var(--ink);color:rgba(245,240,232,0.45);padding:5px var(--g);display:flex;align-items:center;justify-content:space-between;font-family:var(--f-mono);font-size:10px;letter-spacing:.09em;text-transform:uppercase;}
.live{display:flex;align-items:center;gap:6px;color:#87d9a0;font-weight:600;}
.dot{width:6px;height:6px;background:#87d9a0;border-radius:50%;animation:pulse 2.2s ease infinite;}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.3;transform:scale(.65)}}

.masthead{max-width:var(--max);margin:0 auto;padding:20px var(--g) 0;}
.mast-rule{border-top:4px solid var(--ink);margin-bottom:14px;}
.mast-body{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;padding-bottom:12px;border-bottom:1px solid var(--ink);flex-wrap:wrap;}
.mast-title{font-family:var(--f-mast);font-size:clamp(32px,6vw,72px);font-weight:700;letter-spacing:.07em;line-height:1;text-transform:uppercase;color:var(--ink);}
.mast-title span{color:var(--green);}
.mast-meta{font-family:var(--f-mono);font-size:10px;color:var(--ink3);text-align:right;line-height:1.65;flex-shrink:0;}
.mast-meta strong{color:var(--ink2);display:block;}

.subbar{max-width:var(--max);margin:0 auto;padding:9px var(--g);border-bottom:1px solid var(--rule);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;}
.subbar-count{font-family:var(--f-mono);font-size:10px;color:var(--ink3);letter-spacing:.07em;text-transform:uppercase;}
.subbar-count strong{color:var(--green);}

#news-container{max-width:var(--max);margin:0 auto;padding:24px var(--g) 60px;}

.ni{display:grid;grid-template-columns:1fr 130px;gap:16px;align-items:start;padding:20px 0;border-bottom:1px solid var(--rule);animation:fadein .35s ease both;transition:background .13s,padding .13s,margin .13s;}
.ni:first-child{padding-top:0;}
.ni:hover{background:var(--paper2);margin:0 -14px;padding-left:14px;padding-right:14px;}
.ni.feat{grid-template-columns:1fr;border-bottom:3px solid var(--ink);padding-bottom:22px;margin-bottom:2px;}
.ni.feat:hover{margin:0 -14px;padding-left:14px;padding-right:14px;}
.ni.feat .thumb{width:100%;height:260px;margin-bottom:14px;}
.ni.feat .headline{font-size:clamp(22px,3.5vw,34px);line-height:1.15;}
@keyframes fadein{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

.ni-body{min-width:0;}
.ni-meta{display:flex;align-items:center;gap:7px;flex-wrap:wrap;margin-bottom:6px;}
.ni-src{font-family:var(--f-mono);font-size:9px;font-weight:600;letter-spacing:.12em;text-transform:uppercase;color:var(--green);border-bottom:1px solid var(--green);}
.ni-dot{width:3px;height:3px;border-radius:50%;background:var(--rule);flex-shrink:0;}
.ni-time{font-family:var(--f-mono);font-size:9px;color:var(--ink3);}
.headline{font-family:var(--f-head);font-size:18px;font-weight:700;line-height:1.3;color:var(--ink);margin-bottom:5px;transition:color .13s;}
.ni:hover .headline{color:var(--green2);}
.ni-byline{font-family:var(--f-mono);font-size:9px;color:var(--ink3);letter-spacing:.06em;text-transform:uppercase;margin-top:6px;}
.ni-byline span{color:var(--green);text-decoration:underline;text-underline-offset:2px;}

.thumb{width:130px;height:92px;overflow:hidden;background:var(--paper3);border:1px solid var(--rule);display:flex;align-items:center;justify-content:center;font-size:22px;color:var(--ink3);flex-shrink:0;}
.thumb img{width:100%;height:100%;object-fit:cover;display:block;}

.loading{padding:40px 0;text-align:center;font-family:var(--f-mono);font-size:11px;color:var(--ink3);letter-spacing:.08em;text-transform:uppercase;}
.error-msg{padding:20px;border:1px solid var(--red);color:var(--red);font-family:var(--f-mono);font-size:11px;margin-bottom:20px;}

footer{background:var(--ink);color:var(--paper);padding:28px var(--g);text-align:center;margin-top:0;}
.foot-title{font-family:var(--f-mast);font-size:26px;font-weight:700;text-transform:uppercase;letter-spacing:.07em;margin-bottom:8px;}
.foot-title span{color:#87d9a0;}
.foot-legal{font-family:var(--f-mono);font-size:10px;color:rgba(245,240,232,.25);line-height:1.75;}

@media(max-width:640px){
  :root{--g:14px;}
  .ni{grid-template-columns:1fr;}
  .thumb{width:100%;height:180px;}
  .ni.feat .thumb{height:200px;}
  .mast-meta{display:none;}
}
</style>
</head>
<body>

<div class="topbar">
  <span id="topDate">â€”</span>
  <span class="live"><span class="dot"></span>Live Feed</span>
</div>

<div class="masthead">
  <div class="mast-rule"></div>
  <div class="mast-body">
    <div class="mast-title">Florida <span>Trees</span> News</div>
    <div class="mast-meta">
      <strong id="editionLabel">â€”</strong>
      <span id="statLine">Loadingâ€¦</span>
    </div>
  </div>
</div>

<div class="subbar">
  <div class="subbar-count" id="countBar">Loading storiesâ€¦</div>
</div>

<div id="news-container">
  <div class="loading">Loading newsâ€¦</div>
</div>

<footer>
  <div class="foot-title">Florida <span>Trees</span> News</div>
  <div class="foot-legal">This site aggregates public news. All rights belong to their respective owners.<br>Not affiliated with any dispensary or cannabis company. For informational purposes only.</div>
</footer>

<script>
// â”€â”€ exact same fetch as the original working site â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var RSS_URL = 'https://news.google.com/rss/search?q=florida+marijuana+cannabis+hemp&hl=en-US&gl=US&ceid=US:en';

function ago(ms) {
  var s = Math.floor((Date.now() - ms) / 1000);
  if (s < 60) return 'Just now';
  var m = Math.floor(s/60); if (m < 60) return m + 'm ago';
  var h = Math.floor(m/60); if (h < 24) return h + 'h ago';
  var d = Math.floor(h/24); return d === 1 ? 'Yesterday' : d + 'd ago';
}

function esc(s) {
  return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function renderItems(items) {
  var container = document.getElementById('news-container');
  var countBar  = document.getElementById('countBar');

  countBar.innerHTML = '<strong>' + items.length + '</strong> stories loaded';

  // Update meta
  var now = new Date();
  document.getElementById('topDate').textContent = now.toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric',year:'numeric'});
  document.getElementById('editionLabel').textContent = 'Vol. ' + now.getFullYear() + ' Â· Issue ' + Math.ceil((now - new Date(now.getFullYear(),0,0))/86400000);
  document.getElementById('statLine').textContent = 'Updated ' + now.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'});

  container.innerHTML = items.map(function(item, i) {
    var ts    = item.pubDate ? Date.parse(item.pubDate) : Date.now();
    var src   = item.author || 'FL News';
    var thumb = item.thumbnail || '';
    var feat  = i === 0;
    var imgHtml = thumb
      ? '<div class="thumb' + (feat ? '" style="width:100%;height:260px;margin-bottom:14px"' : '"') + '><img src="' + esc(thumb) + '" alt="" loading="lazy" onerror="this.closest(\'.thumb\').innerHTML=\'ðŸ“°\'"></div>'
      : '<div class="thumb' + (feat ? '" style="width:100%;height:260px;margin-bottom:14px"' : '"') + '">ðŸ“°</div>';

    return '<a class="ni' + (feat?' feat':'') + '" href="' + esc(item.link) + '" target="_blank" rel="noopener" style="animation-delay:' + (i*0.04) + 's">'
      + (feat ? imgHtml : '')
      + '<div class="ni-body">'
      + '<div class="ni-meta"><span class="ni-src">' + esc(src) + '</span><span class="ni-dot"></span><span class="ni-time">' + ago(ts) + '</span></div>'
      + '<div class="headline">' + esc(item.title) + '</div>'
      + '<div class="ni-byline"><span>' + esc(src) + '</span> â€” Read full story â†’</div>'
      + '</div>'
      + (feat ? '' : imgHtml)
      + '</a>';
  }).join('');
}

function showError(msg) {
  document.getElementById('news-container').innerHTML = '<div class="error-msg">' + msg + '</div>';
}

// Exact fetch from original
async function fetchNews() {
  try {
    var rss = encodeURIComponent(RSS_URL);
    var res = await fetch('https://api.rss2json.com/v1/api.json?rss_url=' + rss);
    var data = await res.json();
    if (!data.items || data.items.length === 0) {
      showError('No news found.');
      return;
    }
    renderItems(data.items);
  } catch(e) {
    console.error(e);
    showError('Failed to load news. Retrying in 30 secondsâ€¦');
    setTimeout(fetchNews, 30000);
  }
}

fetchNews();
setInterval(fetchNews, 600000);
</script>
</body>
</html>
